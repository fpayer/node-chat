(function(window){var stream=new DuplexEvent;localStorage.room=localStorage.room||"All";window.api=function(){var name;return{setBotName:function(newName){name=newName},setKey:function(key){$.ajaxSetup({headers:{"X-Mashape-Key":key}})},sendMessage:function(message){socket.emit("message",{time:(new Date).toLocaleTimeString(),name:name?name:localStorage.name+"'s Bot",text:message,bot:true})}}}();var App=React.createClass({displayName:"App",getInitialState:function(){return{name:localStorage.name,room:localStorage.room}},loadSettings:function(){this.setState({name:localStorage.name,room:localStorage.room});$(React.findDOMNode(this.refs.name)).val(localStorage.name);$(React.findDOMNode(this.refs.room)).val(localStorage.room);socket.emit("join",localStorage.room);socket.emit("name",localStorage.name)},setName:function(e){var text=$(React.findDOMNode(this.refs.name)).val();if(e.keyCode){if(e.keyCode===13&&text.trim()!==""){localStorage.name=text;this.loadSettings();$(".modal").modal("hide")}}else{localStorage.name=text;this.loadSettings();$(".modal").modal("hide")}},componentDidMount:function(){var _this=this;if(!this.state.name){$(".modal").modal({closable:false,onShow:function(){$(".modal input").focus()}}).modal("show")}stream.on("name",function(e,name){localStorage.name=name;_this.loadSettings()});stream.on("room",function(e,room){localStorage.room=room;_this.loadSettings()});this.loadSettings()},render:function(){return React.createElement("div",{style:{height:"100%"}},React.createElement("div",{style:{height:"100%"},id:"main"},React.createElement(Component.ChatBox,{name:this.state.name,room:this.state.room,stream:stream}),React.createElement(Component.Sidebar,{name:this.state.name,room:this.state.room,stream:stream}),React.createElement("div",{className:"ui small modal"},React.createElement("div",{className:"header"},"What is your name?"),React.createElement("div",{className:"content"},React.createElement("div",{className:"ui fluid action input"},React.createElement("input",{type:"text",placeholder:"Enter your name",ref:"name",onKeyUp:this.setName}),React.createElement("button",{className:"ui blue right labeled button",onClick:this.setName},"Enter"))))),React.createElement(Component.Editor,{name:this.state.name}))}});window.Component.App=App})(window);(function(window){var ChatBox=React.createClass({displayName:"ChatBox",addMessage:function(payload){this.state.messages.push(payload);this.setState({messages:this.state.messages});$("#chatter").animate({scrollTop:$("#chatter").prop("scrollHeight")},50)},componentDidMount:function(){var _this=this;socket.on("message",function(data){_this.addMessage(data);if(!data.bot){try{(function(){eval(localStorage.code)(data.time,data.name,data.text)})()}catch(e){}}})},getInitialState:function(){return{messages:[]}},sendMessage:function(e){var _this=this;var text=$(React.findDOMNode(this.refs.message)).val();var exec=function(){socket.emit("message",{time:(new Date).toLocaleTimeString(),name:_this.props.name,text:text});$(React.findDOMNode(_this.refs.message)).val("")};if(e.keyCode){if(e.keyCode===13&&text.trim()!==""){exec()}}else{exec()}},render:function(){return React.createElement("div",{style:_={height:"100%",width:"calc(100% - 440px)"}},React.createElement("div",{id:"chatter",className:"chatter"},React.createElement("table",{id:"chat",className:"ui celled striped table left"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"NodeJS Chat App"))),React.createElement("tbody",{id:"messages"},this.state.messages.map(function(item,index){return React.createElement("tr",{key:index},React.createElement("td",null,"["+item.time+"] "+item.name+" - "+item.text))})))),React.createElement("div",{id:"message-box",className:"message-box"},React.createElement("div",{className:"ui fluid action input"},React.createElement("input",{ref:"message",id:"message-input",type:"text",placeholder:"Enter message here",autoComplete:"off",onKeyUp:this.sendMessage}),React.createElement("button",{id:"message-btn",className:"ui blue right labeled button",onClick:this.sendMessage},"Send"))))}});window.Component.ChatBox=ChatBox})(window);(function(window){localStorage.code=localStorage.code||"(function(time, name, text) {\n	api.setBotName('My First Bot');\n	api.setKey('');\n	$.get('').done(function(resp) {\n		\n	});\n});";var botEditor;var Editor=React.createClass({displayName:"Editor",componentDidMount:function(){var _this=this;botEditor=ace.edit("bot-box");botEditor.setTheme("ace/theme/monokai");botEditor.getSession().setMode("ace/mode/javascript");botEditor.setShowPrintMargin(false);botEditor.getSession().setValue(localStorage.code)},addMessage:function(payload){this.state.messages.push(payload);this.setState({messages:this.state.messages});$("#testChatter").animate({scrollTop:$("#testChatter").prop("scrollHeight")},50)},getInitialState:function(){var error;try{eval(localStorage.code);error=false}catch(e){error=true}return{messages:[],error:error}},validate:function(){var _this=this;var code=$.trim(botEditor.getSession().getValue());try{var bot=eval(code);_this.setState({error:bot?false:true})}catch(e){_this.setState({error:true})}},back:function(){$("#editor").swapPage($("#main"))},save:function(){notify("Bot successfully saved",null,null);localStorage.code=botEditor.getSession().getValue()},sendMessage:function(e){var _this=this;var text=$(React.findDOMNode(this.refs.message)).val();var exec=function(){var payload={time:(new Date).toLocaleTimeString(),name:_this.props.name,text:text};_this.addMessage(payload);try{(function(){var code=botEditor.getSession().getValue();var api=function(){var name;return{setBotName:function(newName){name=newName},setKey:function(key){$.ajaxSetup({headers:{"X-Mashape-Key":key}})},sendMessage:function(message){_this.addMessage({time:(new Date).toLocaleTimeString(),name:name?name:localStorage.name+"'s Bot",text:message})}}}();eval(code)(payload.time,payload.name,payload.text)})()}catch(e){_this.addMessage({time:(new Date).toLocaleTimeString(),name:name?name:localStorage.name+"'s Bot",text:e.message+" at line "+e.stack.match(/<anonymous>:(\d)/)[1],error:true})}$(React.findDOMNode(_this.refs.message)).val("")};if(e.keyCode){if(e.keyCode===13&&text.trim()!==""){exec()}}else{exec()}},render:function(){return React.createElement("div",{style:_={height:"100%",display:"none"},id:"editor"},React.createElement("div",{style:_={height:"50%",width:"100%",borderBottom:"1px solid black"},id:"bot-box",onKeyUp:this.validate}),React.createElement("div",{style:_={height:"50%",width:"calc(100% - 440px)"},id:"test-box"},React.createElement("div",{className:"chatter",id:"testChatter"},React.createElement("table",{style:{margin:"10px"},className:"ui celled striped table left"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Bot Testing"))),React.createElement("tbody",null,this.state.messages.map(function(item,index){return React.createElement("tr",{key:index},React.createElement("td",{style:item.error?{color:"red"}:{}},"["+item.time+"] "+item.name+" - "+item.text))})))),React.createElement("div",{className:"message-box"},React.createElement("div",{className:"ui fluid action input"},React.createElement("input",{ref:"message",type:"text",placeholder:"Enter message here",autoComplete:"off",onKeyUp:this.sendMessage}),React.createElement("button",{className:"ui blue right labeled button",onClick:this.sendMessage},"Send")))),React.createElement("div",{style:_={position:"absolute",bottom:"25px",right:"180px"}},React.createElement("i",{className:"ui huge icon "+(!this.state.error?"green check circle":"red minus circle")})),React.createElement("div",{style:_={position:"absolute",bottom:"25px",right:"100px"},onClick:this.save},React.createElement("i",{className:"ui huge link save icon"})),React.createElement("div",{style:_={position:"absolute",bottom:"25px",right:"20px"},onClick:this.back},React.createElement("i",{className:"ui huge link reply icon"})))}});window.Component.Editor=Editor})(window);(function(window){var Sidebar=React.createClass({displayName:"Sidebar",componentDidMount:function(){var _this=this;socket.on("users",function(users){_this.setState({users:users})})},getInitialState:function(){return{users:[]}},setName:function(){var name=$(React.findDOMNode(this.refs.name)).val();if(name!==this.props.name){this.props.stream.emit("name",name);notify("Username updated",null,null)}},setRoom:function(){var room=$(React.findDOMNode(this.refs.room)).val();if(room!==this.props.room){this.props.stream.emit("room",room);notify("Switched rooms",null,null)}},openEditor:function(){$("#main").swapPage($("#editor"))},render:function(){return React.createElement("div",{id:"sidebar"},React.createElement("table",{id:"info",className:"ui celled striped table right"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Settings")),React.createElement("tr",null,React.createElement("td",null,React.createElement("div",{className:"ui form",ref:"infoForm"},React.createElement("div",{className:"two fields"},React.createElement("div",{className:"field"},React.createElement("label",null,"Username"),React.createElement("input",{type:"text",name:"name",ref:"name",defaultValue:this.props.name,onBlur:this.setName})),React.createElement("div",{className:"field"},React.createElement("label",null,"Chatroom"),React.createElement("input",{type:"text",name:"room",ref:"room",defaultValue:this.props.room,onBlur:this.setRoom}))),React.createElement("div",{className:"field"},React.createElement("div",{className:"ui fluid blue button",onClick:this.openEditor},"Configure Bot"))))))),React.createElement("table",{className:"ui celled striped table right"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Online Users ["+this.props.room+"]"))),React.createElement("tbody",null,this.state.users.map(function(user){return React.createElement("tr",{key:user},React.createElement("td",null,user))}))))}});window.Component.Sidebar=Sidebar})(window);